<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.elextec.persist.dao.mybatis.BizOrganizationMapperExt">

    <!--根据code查询-->
    <select id="getByCode" parameterType="java.lang.String" resultType="com.elextec.persist.model.mybatis.BizOrganization">
        SELECT * FROM biz_organization WHERE org_code = #{orgCode,jdbcType=VARCHAR}
    </select>

    <select id="selectByParam" parameterType="com.elextec.lease.manager.request.BizOrganizationParam" resultMap="BaseResultMap">
        SELECT distinct
        o.id,
        o.org_code,
        o.org_name,
        o.org_type,
        o.org_introduce,
        o.org_address,
        o.org_contacts,
        o.org_phone,
        o.org_business_licences,
        o.org_business_licence_front,
        o.org_business_licence_back,
        o.org_status,
        o.create_user,
        o.create_time,
        o.update_user,
        o.update_time
        FROM biz_organization o
        <where>
            1=1
            <if test="keyStr != null and keyStr != ''" >
                AND (o.org_code LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_name LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_introduce LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_address LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_contacts LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_phone LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
                OR o.org_business_licences LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%'))
            </if>
            <if test="orgType != null and orgType != ''" >
                AND o.org_type = #{orgType,jdbcType=VARCHAR}
            </if>
            <if test="orgStatus != null and orgStatus != ''" >
                AND o.org_status = #{orgStatus,jdbcType=VARCHAR}
            </if>
        </where>
        ORDER BY o.update_time DESC,o.create_time DESC
        limit #{pageBegin} , #{pageSize}
    </select>

    <select id="countByParam" parameterType="com.elextec.lease.manager.request.BizOrganizationParam" resultType="java.lang.Integer">
      SELECT count(distinct o.id) FROM biz_organization o
      <where>
          1=1
          <if test="keyStr != null and keyStr != ''" >
              AND (o.org_code LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_name LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_introduce LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_address LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_contacts LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_phone LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%')
              OR o.org_business_licences LIKE concat('%',#{keyStr,jdbcType=VARCHAR},'%'))
          </if>
          <if test="orgType != null and orgType != ''" >
              AND o.org_type = #{orgType,jdbcType=VARCHAR}
          </if>
          <if test="orgStatus != null and orgStatus != ''" >
              AND o.org_status = #{orgStatus,jdbcType=VARCHAR}
          </if>
      </where>
    </select>

</mapper>